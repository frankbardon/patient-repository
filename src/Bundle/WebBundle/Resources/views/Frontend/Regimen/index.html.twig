{# This file is part of the Accard package. #}

{# (c) University of Pennsylvania #}

{# For the full copyright and license information, please view the LICENSE #}
{# file that was distributed with this source code. #}

{% extends 'AccardWebBundle:Frontend:layout.html.twig' %}

{% from 'AccardWebBundle:Common/Macros:buttons.html.twig' import design %}
{% from 'AccardWebBundle:Common/Macros:misc.html.twig' import pagination, page_title %}
{% from 'AccardWebBundle:Frontend/Regimen:macros.html.twig' import list %}

{% set settings = accard_settings('regimen') %}
{% set designBtn = null %}

{% if is_granted('ROLE_ADMIN') %}
    {% set designBtn = design(path('accard_backend_regimen_design'), 'accard.regimen.action.design'|trans) %}
{% endif %}

{% block content %}
    {% block page_title %}
        {{ page_title('accard.regimen.title.index'|trans, designBtn) }}
    {% endblock %}

    {% block regimen_tabs %}
        {% include 'AccardWebBundle:Frontend/Activity:tabs.html.twig' %}
        {{ render(controller('AccardWebBundle:Frontend:prototypeChoiceForm', { 'type' : 'regimen' })) }}
    {% endblock %}

    {% block regimen_content %}
        {{ list(regimens) }}
        {{ pagination(regimens) }}
    {% endblock %}
{% endblock %}

{% block page_javascripts %}
<script type="text/javascript" defer>
    var Tabler = Accard.get('table');
    var regimens = new Tabler('#regimens');

    regimens
        .plugin('autohighlighting', {
            id: 'regimen-{{ app.request.query.get('id', 0) }}',
            className: 'info'
        })
        .bindAll()
    ;
</script>
{% endblock %}